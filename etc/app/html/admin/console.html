<!DOCTYPE html>
<html tpl:variable.pdf="'paspdf'" lang="en" xmlns:tpl="http://software.in2p3.fr/lavoisier/template.xsd"     xmlns:date="http://exslt.org/dates-and-times">
<head tpl:include="/resource/app/html/header.html"></head>

<body class="sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed"
      cz-shortcut-listen="true">
<div class="wrapper">

    <!-- Navbar -->
    <nav tpl:include="/resource/app/html/navbar.html"></nav>
    <!-- /.navbar -->

    <!-- Main Sidebar Container -->
    <aside tpl:include="/resource/app/html/sidebar.html"></aside>
    <!-- /sidebar -->


    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-9">

                        </div><!-- /.col -->
                        <div class="col-sm-3">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a href="/admin/console">Admin console </a></li>

                            </ol>
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.container-fluid -->
            </div>

        <!-- Main content -->
        <div class="content" tpl:foreach="/root[not(@exception)]">

<!--            <div class="container-fluid">-->
<!--                <div class="col-4 m-2"><h3><i class="fas fa-user m-1"></i>  Welcome {{object/name/text()}}</h3> </div>-->
<!--            </div>-->

            <div class="container-fluid">

                <div class="row">
                <div class="card col-3 m-1" tpl:foreach="/root/argo-ui-status">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-database m-1"></i> Data views of the UI</div>
                        <ul class="card-tools">
                            <button type="button" class="btn btn-tool" data-card-widget="maximize"><i class="fas fa-expand"></i>
                            </button>
                            <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i>
                            </button>
                        </ul>
                    </div>
                    <div class="card-body" >
                        <div tpl:foreach="view" ><span class="m-1 badge badge-{{@status}}"> {{@count}} : {{@status}} </span><br/></div>

                        <hr/>


                        <div class="align-content-center">

                            <button class="btn btn-info m-1" id="reloadTenants">Reload tenants configuration</button><br/>

                        </div>

                    </div>
                </div>

                <div class="card col-4 m-1" tpl:foreach="/root/reports-status">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-clipboard-check m-1"></i> Status reports</div>
                        <ul class="card-tools">
                            <button type="button" class="btn btn-tool" data-card-widget="maximize"><i class="fas fa-expand"></i>
                            </button>
                            <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i>
                            </button>
                        </ul>
                    </div>
                    <div class="card-body" >
                        <table id="console_status" class="dataTable table table-condensed">
                            <thead>
                            <tr>
                                <th>Tenant</th>
                                <th>Report </th>
                                <th>Status</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr tpl:foreach="tenants/tenant/reports">
                                <td>{{@tenant}}</td>
                                <td>{{@name}}</td>
                                <th tpl:if="count(report)&gt;0"><i class="fas fa-check-double text-success"></i> <span class="d-none">10</span> </th>
                                <th tpl:else=""><i class="fas fa-skull-crossbones text-danger"></i><span class="d-none">0</span>  </th>

                            </tr>

                            </tbody>

                        </table>
                    </div>
                </div>

                    <div class="card col-4 m-1" tpl:foreach="/root/reports-ar">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-chart-bar m-1"></i> AR reports</div>
                            <ul class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="maximize"><i class="fas fa-expand"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i>
                                </button>
                            </ul>
                        </div>
                        <div class="card-body" >
                            <table id="console_ar" class="dataTable table table-condensed">
                                <thead>
                                <tr>
                                    <th>Tenant</th>
                                    <th>Report </th>
                                    <th>Status</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr tpl:foreach="tenants/tenant/reports">
                                    <td>{{@tenant}}</td>
                                    <td>{{@name}}</td>
                                    <th tpl:if="count(report/@exception)=0"><i class="fas fa-check-double text-success"></i><span class="d-none">10</span> </th>
                                    <th tpl:else=""><i class="fas fa-skull-crossbones text-danger"></i> <span class="d-none">0</span> </th>

                                </tr>

                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>




            </div>


        </div>

        <div class="content" tpl:foreach="/root[@exception]">
            <h2> <span class="fa fa-2x fa-exclamation-triangle  text-danger"></span> You are not administrator of this service . Sorry, You Are Not Allowed to Access This Page .</h2>

        </div>
        <!-- /.container-fluid -->

        <!-- /.content -->
    </div>

    <!-- /.content-wrapper -->
    <!-- Main Footer -->

    <footer tpl:include="/resource/app/html/footer.html"></footer>
</div>
<!-- ./wrapper -->

<!-- REQUIRED SCRIPTS -->


<!-- jQuery -->

<script src="/resource/app/html/adminlte/plugins/jquery/jquery.min.js?v={$app.version}"></script>
<!-- Bootstrap -->
<script src="/resource/app/html/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js?v={$app.version}"></script>
<!-- adminlte -->
<script src="/resource/app/html/adminlte/dist/js/adminlte2.min.js?v={$app.version}"></script>

<link rel="stylesheet"     href="/resource/app/css/dataTables.bootstrap5.min.css?v={$app.version}"/>
<script src="/resource/app/js/jquery.dataTables.min.js?v={$app.version}"></script>
<script src="/resource/app/js/dataTables.bootstrap5.min.js?v={$app.version}"></script>

<script src="/resource/app/js/dataTable.js?v={$app.version}"></script>

<script src="/resource/app/html/adminlte/plugins/select2/select2.full.min.js?v={$app.version}"></script>
<script src="/resource/app/js/select.js?v={$app.version}"></script>

<script>
    $(document).ready(function() {
        $("#reloadTenants").on('click', function () {

            $.ajax({
                type: 'GET',
                url: '/notify/tenants',


                beforeSend: function () {
                    $("#reloadTenants").html('<div class="spinner-border text-white" role="status"><span class="sr-only">Loading...</span></div>');
                },
                success: function (code_html, statut) {
                    setTimeout(function () {
                        location.reload();
                    }, 4000);
                },

                error: function (resultat, statut, erreur) {
                    $("#reloadTenants").html('<div><span class="badge badge-danger">Reload of the configuration has failed !</span> </div>');

                }

            });
        });
    })


</script>

</body>
</html>
