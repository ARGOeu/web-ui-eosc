<!DOCTYPE html>
<html lang="en" xmlns:tpl="http://software.in2p3.fr/lavoisier/template.xsd">

<head tpl:include="/resource/app/html/header.html"></head>

<body class="sidebar-mini layout-fixed layout-navbar-fixed">
<div class="wrapper">
    <!-- Navbar -->
    <nav tpl:include="/resource/app/html/navbar.html"></nav>
    <!-- /.navbar -->

    <!-- Main Sidebar Container -->
    <aside tpl:include="/resource/app/html/sidebar.html"></aside>
    <!-- /sidebar -->

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <div class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-9">

                    </div><!-- /.col -->
                    <div class="col-sm-3">
                        <ol class="breadcrumb float-sm-right">
                            <li class="breadcrumb-item"><a href="/">Home</a></li>
                            <li class="breadcrumb-item active"><a href="/{{/root/@tenant}}/issues/{{/root/@report}} ">Issues</a></li>

                        </ol>
                    </div><!-- /.col -->
                </div><!-- /.row -->
            </div><!-- /.container-fluid -->
        </div>
        <!-- /.content-header -->

        <!-- Main content -->
        <div class="content">
            <div class="container-fluid">
                <div class="row">


                    <div class="info-box m-1 col-3">
                        <span class="info-box-icon bg-info"><i class="far fa-id-card"></i></span>
                        <div class="info-box-content">
                            <span class="info-box-text">{{/root/@report}} Report</span>
                            <span class="info-box-number">{{count(/root/issues)}} problematic groups</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>


                    <div class="info-box m-1 col-3" tpl:if="count(/root/issues/issue[status/text()='OK'])&gt;0">
                        <span class="info-box-icon bg-OK"><i class="far fa-thumbs-up"></i></span>
                        <div class="info-box-content">
                            <a class="filter-status" id="status_OK" href="#OK"><span class="info-box-text">OK</span></a>
                            <span class="info-box-number">{{count(/root/issues/issue[status/text()='OK'])}}</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>

                    <div class="info-box m-1 col-3" tpl:if="count(/root/issues/issue[status/text()='CRITICAL'])&gt;0">
                        <span class="info-box-icon bg-CRITICAL"><i class="fas fa-times-circle"></i></span>
                        <div class="info-box-content">
                            <a class="filter-status" id="status_CRITICAL" href="#CRITICAL"><span class="info-box-text">CRITICAL</span></a>
                            <span class="info-box-number">{{count(/root/issues/issue[status/text()='CRITICAL'])}}</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>

                    <div class="info-box m-1 col-3" tpl:if="count(/root/issues/issue[status/text()='WARNING'])&gt;0">
                        <span class="info-box-icon bg-WARNING"><i class="fas fa-exclamation-triangle"></i></span>
                        <div class="info-box-content">
                            <a class="filter-status" id="status_WARNING" href="#WARNING"><span class="info-box-text">WARNING</span></a>
                            <span class="info-box-number">{{count(/root/issues/issue[status/text()='WARNING'])}}</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>

                    <div class="info-box m-1 col-3" tpl:if="count(/root/issues/issue[status/text()='DOWNTIME'])&gt;0">
                        <span class="info-box-icon bg-DOWNTIME"><i class="far fa-calendar-times"></i></span>
                        <div class="info-box-content">
                            <a class="filter-status" id="status_DOWNTIME" href="#DOWNTIME"><span class="info-box-text">DOWNTIME</span></a>

                            <span class="info-box-number">{{count(/root/issues/issue[status/text()='DOWNTIME'])}}</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>

                    <div class="info-box m-1 col-3" tpl:if="count(/root/issues/issue[status/text()='UNKNOWN'])&gt;0">
                        <span class="info-box-icon bg-UNKNOWN"><i class="fas fa-question-circle text-dark"></i></span>
                        <div class="info-box-content">
                            <a class="filter-status" id="status_UNKNOWN" href="#UNKNOWN"><span class="info-box-text">UNKNOWN</span></a>
                            <span class="info-box-number">{{count(/root/issues/issue[status/text()='UNKNOWN'])}}</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>

                    <div class="info-box m-1 col-3" tpl:if="count(/root/issues/issue[status/text()='MISSING'])&gt;0">

                        <span class="info-box-icon bg-MISSING"><i class="fas fa-unlink"></i></span>
                        <div class="info-box-content">
                            <a class="filter-status" id="status_MISSING" href="#MISSING"><span class="info-box-text">MISSING</span></a>
                            <span class="info-box-number">{{count(/root/issues/issue[status/text()='MISSING'])}}</span>
                        </div>
                        <!-- /.info-box-content -->
                    </div>
                </div>
                <div class="row mb-2">
                    <div class="float-left">
                        <div class="input-group m-1">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-filter"><i
                                        class="m-1 fas fa-filter"></i></span>
                            </div>
                            <input type="text" class="form-control" id="input-site-filter"
                                   placeholder="filter by site name" aria-label="filter" aria-describedby="basic-filter"
                                   onkeyup="filter(this)"/>
                            <a class="erase" id="erase-input-site-filter"> <i class="fas fa-trash-alt m-1"/></a>

                        </div>
                    </div>
                    <div class="ml-4">
                        <div class="input-group m-1">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="status-filter"><i
                                        class="m-1 fas fa-filter"></i></span>
                            </div>
                            <input type="text" id="input-status-filter" class="form-control"
                                   placeholder="filter by status" aria-label="filter" aria-describedby="basic-filter2"
                                   onkeyup="filterStatus(this)"/>
                            <a class="erase" id="erase-input-status-filter"> <i class="fas fa-trash-alt m-1"/></a>
                        </div>
                    </div>



                </div>


                <div class="row">


                    <div tpl:foreach="/root/issues" class="col-8 card">
                        <div class="card-header row">
                            <h4 class="col-3">
                                <div class="group small">{{@key}}</div>
                            </h4>
                            <div tpl:foreach="issue" class="col-1 text-center">                             
                                <span class="d-block status m-1 badge badge-{{status/text()}}">{{status/text()}}</span>
                            </div>
                            <div class="ml-auto">
                                <a  class="toggle-body" id="toggle_{{@key}}"> <i class="fas fa-angle-double-down text-primary"></i></a>
                            </div>
                        </div>
                        <div class="card-body d-none row" id="body-{{@key}}" >
                           <div tpl:foreach="issue" class="col-3">
                               <span class="d-block status m-1 badge badge-{{status/text()}}">{{status/text()}}</span>
                               <ul >
                                   <li><strong>Service: </strong>{{service}}</li>
                                   <li><strong>Endpoint: </strong>{{endpoint}}</li>
                                   <li><strong>Timestamp: </strong>{{timestamp}}</li>
                                   <li><a href="/{/root/@tenant}/report-status/{/root/@report}/{/root/report[@tenant=/root/@tenant][@report=/root/@report]/@topology2}/{@key}/{service}/{endpoint}"><span class="fa fa-link m-1"></span>Status for last 5 days</a></li>

                               </ul>
                           </div>
                            <div class="ml-auto">
                                <a  class="untoggle-body" id="untoggle_{{@key}}"> <i class="fas fa-angle-double-up text-primary"></i></a>
                            </div>
                        </div>
                    </div>


                </div>


                <!-- /.container-fluid -->
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->
    </div>
        <!-- Main Footer -->
    <div class='clearfix'></div>
        <footer tpl:include="/resource/app/html/footer.html"></footer>

</div>


        <!-- ./wrapper -->

        <!-- REQUIRED SCRIPTS -->

        <!-- jQuery -->
        <script src="/resource/app/html/adminlte/plugins/jquery/jquery.min.js?v={$app.version}"></script>
        <!-- Bootstrap -->
        <script src="/resource/app/html/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js?v={$app.version}"></script>
        <!-- adminlte -->
        <script src="/resource/app/html/adminlte/dist/js/adminlte.js?v={$app.version}"></script>

<script src="/resource/app/js/status-ng.js?v={$app.version}"></script>
        <!-- LOCAL SCRIPTS -->
</body>


</html>

